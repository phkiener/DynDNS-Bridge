<Project Sdk="Microsoft.NET.Sdk.Web">
  <UsingTask TaskName="CopyCssScope.InheritStyles" AssemblyFile="../../tools/CopyCssScope/bin/Debug/netstandard2.0/CopyCssScope.dll" />

  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>
  
  <ItemGroup>
    <ProjectReference Include="../../tools/CopyCssScope/CopyCssScope.csproj" PrivateAssets="All" />
  </ItemGroup>
  
  <ItemGroup>
    <Content Update="appsettings.*.json">
      <DependentUpon>appsettings.json</DependentUpon>
    </Content>
    
    <InheritStyles Include="WebInterface/Components/ZoneTemplate.razor" Inherit="WebInterface/Components/Zone.razor" />
  </ItemGroup>
  
  <Target Name="_CopyCssScopes" AfterTargets="ResolveRazorComponentInputs;ResolveCssScopes" BeforeTargets="AssignRazorComponentTargetPaths">
    <InheritStyles Items="@(InheritStyles)" AllComponents="@(RazorComponent)" AllStylesheets="@(_ScopedCss)">
      <Output TaskParameter="ModifiedComponents" ItemName="_ModifiedComponent" />
      <Output TaskParameter="ModifiedStylesheets" ItemName="_ModifiedStylesheet" />
    </InheritStyles>

    <ItemGroup>
      <RazorComponent Remove="@(_ModifiedComponent)" />
      <RazorComponent Include="@(_ModifiedComponent)" />
      
      <_ScopedCss Remove="@(_ModifiedStylesheet)" />
      <_ScopedCss Include="@(_ModifiedStylesheet)" />
    </ItemGroup>
  </Target>
</Project>
 
